/*
use School
CREATE TABLE STU_UNION(SNO CHAR(5) NOT NULL UNIQUE,
						SNAME CHAR(8),
						SSEX CHAR(1),
						SAGE INT,
						SDEPT CHAR(20),
						CONSTRAINT PK_STU_UNION PRIMARY KEY(SNO));
INSERT INTO STU_UNION VALUES('10001', '李勇', '0', 24, 'EE');
INSERT INTO STU_UNION VALUES('95002', '王敏', '1', 23, 'CS');
INSERT INTO STU_UNION VALUES('95003', '王浩', '0', 25, 'EE');
INSERT INTO STU_UNION VALUES('95005', '王杰', '0', 25, 'EE');
INSERT INTO STU_UNION VALUES('95009', '李勇', '0', 25, 'EE');
SELECT * FROM STU_UNION
*/

/*
CREATE TABLE COURSE(
	CNO CHAR(4) NOT NULL UNIQUE,
	CNAME VARCHAR(50) NOT NULL,
	CPOINTS INT,
	CONSTRAINT PK PRIMARY KEY(CNO));
INSERT COURSE VALUES ('0001', 'COMPUTERNETWORKS', 2);
INSERT COURSE VALUES ('0002', 'DATABASE', 3);
SELECT * FROM COURSE
*/

/*
CREATE TABLE SC(
SNO CHAR(5) REFERENCES STU_UNION (SNO) ON DELETE CASCADE,
CNO CHAR(4) REFERENCES COURSE(CNO) ON DELETE CASCADE,
GRADE INT,
CONSTRAINT PK_SC PRIMARY KEY (SNO,CNO)
);

INSERT INTO SC VALUES ('95002', '0001', 2);
INSERT INTO SC VALUES ('95002', '0002', 2);
INSERT INTO SC VALUES ('10001', '0001', 2);
INSERT INTO SC VALUES ('10001', '0002', 2);
SELECT * FROM SC;
 */
 
 --INSERT INTO SC VALUES('99', '0001', 2);
 
 /*
 DELETE FROM STU_UNION WHERE SNO='10001';
 SELECT * FROM SC;
 */
 /*
 CREATE TABLE STU_CARD(
		CARD_ID CHAR(14),
		STU_ID CHAR(10) REFERENCES STUDENTS(SID) ON DELETE CASCADE,
		REMAINED_MONEY DECIMAL (10,2),
		CONSTRAINT PK_STU_CARD PRIMARY KEY (CARD_ID));

INSERT INTO STU_CARD VALUES ('05212567', '800001216', 100.25);
INSERT INTO STU_CARD VALUES ('05212222', '800005753', 200.50);

SELECT * FROM STU_CARD;
*/

/*
CREATE TABLE ICBC_CARD(
		BANK_ID CHAR(20),
		STU_CARD_ID CHAR(14) REFERENCES STU_CARD(CARD_ID) ON DELETE CASCADE,
		RESTORED_MONEY DECIMAL (10,2),
		CONSTRAINT PK_ICBC_CARD PRIMARY KEY (BANK_ID));
INSERT INTO ICBC_CARD VALUES('9558844022312', '05212567', 15000.1);
INSERT INTO ICBC_CARD VALUES('9558844023645', '05212222', 50000.3);
SELECT * FROM ICBC_CARD;
*/

--delete from STUDENTS where sid='800001216';

/*
ALTER TABLE CHOICES DROP [FK_CHOICES_STUDENTS];
ALTER TABLE CHOICES ADD
CONSTRAINT [FK_CHOICES_STUDENTS] FOREIGN KEY
	(
		[SID]
	)REFERENCES [DBO].[STUDENTS](
		[SID]
	)ON DELETE CASCADE;
DELETE FROM STUDENTS WHERE SID='800001216';
SELECT * FROM STU_CARD;
SELECT * FROM ICBC_CARD;
*/
/*
ALTER TABLE ICBC_CARD
	DROP CONSTRAINT FK__ICBC_CARD__STU_C__3E52440B;
ALTER TABLE ICBC_CARD
	ADD CONSTRAINT FK_ICBC_CARD FOREIGN KEY(STU_CARD_ID)
								REFERENCES STU_CARD(CARD_ID) ON DELETE NO ACTION;
*/
/*
ALTER TABLE SC 
	DROP CONSTRAINT FK__SC__CNO__37A5467C;
ALTER TABLE SC
	DROP CONSTRAINT FK__SC__SNO__36B12243;

ALTER TABLE SC
	ADD CONSTRAINT FK_SC_CNO FOREIGN KEY(CNO) 
		REFERENCES COURSE(CNO) ON DELETE NO ACTION;
ALTER TABLE SC
	ADD CONSTRAINT FK_SC_SNO FOREIGN KEY(SNO) 
		REFERENCES STU_UNION(SNO) ON DELETE NO ACTION;
*/
/*
ALTER TABLE SC 
	DROP CONSTRAINT FK_SC_CNO;
ALTER TABLE SC
	DROP CONSTRAINT FK_SC_SNO;
ALTER TABLE SC
	ADD CONSTRAINT FK_SC_CNO FOREIGN KEY(CNO) 
		REFERENCES COURSE(CNO) ON DELETE SET nuLL;
ALTER TABLE SC
	ADD CONSTRAINT FK_SC_SNO FOREIGN KEY(SNO) 
		REFERENCES STU_UNION(SNO) ON DELETE SET NULL;*/
/*
BEGIN TRANSACTION DEL
DELETE FROM STUDENTS WHERE sid='800005753';
SELECT * FROM STU_CARD;
SELECT * FROM ICBC_CARD;
COMMIT TRANSACTION DEL
*/
BEGIN TRANSACTION T3
ALTER TABLE ICBC_CARD
	DROP CONSTRAINT FK_ICBC_CARD;
ALTER TABLE ICBC_CARD
	ADD CONSTRAINT FK_ICBC_CARD FOREIGN KEY(STU_CARD_ID)
								REFERENCES STU_CARD(CARD_ID) ON DELETE SET NULL;
DELETE FROM STUDENTS WHERE sid='80002933'
SELECT * FROM ICBC_CARD
COMMIT TRANSACTION T3
/*
CREATE TABLE LISTEN_COURSE(
	TEACHER_id char(6),
	tname varchar(20),
	course_id CHAR(4),
	CONSTRAINT PK_LISTEN_COURSE prImary KEY (TEACHER_ID)
)

CREATE TABLE TEACH_COURSE(
	COURSE_ID CHAR(4),
	CNAME VARCHAR(30),
	TEACHER_ID CHAR(6),
	CONSTRAINT PK_TEACH_COURSE PRIMARY KEY(COURSE_ID)
)*/
/*
	CONSTRAINT FK_TEACH_COURSE FOREIGN KEY(TEACHER_ID) REFERENCES LISTEN_COURSE(TEACHER_ID)
	CONSTRAINT FK_LISTEN_COURSE FOREIGN KEY(COURSE_ID) REFERENCES TEACH_COURSE(COURSE_ID)
*/
/*
ALTER TABLE LISTEN_COURSE
	ADD CONSTRAINT FK_LISTEN_COURSE FOREIGN KEY (COURSE_ID)
					REFERENCES TEACH_COURSE(COURSE_ID)

ALTER TABLE TEACH_COURSE
	ADD CONSTRAINT FK_TEACH_COURSE FOREIGN KEY (TEACHER_ID)
					REFERENCES LISTEN_COURSE(TEACHER_ID)
*/
					
					